
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Mach1 SDK Reference & Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;cpp&quot;,&quot;swift&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="cpp">cpp</a>
              <a href="#" data-language-name="swift">swift</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#contents" class="toc-h1 toc-link" data-title="Contents">Contents</a>
          </li>
          <li>
            <a href="#mach1encode-api" class="toc-h1 toc-link" data-title="Mach1Encode API">Mach1Encode API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#generate-point-results" class="toc-h2 toc-link" data-title="Mach1Encode API">Generate Point Results</a>
                  </li>
                  <li>
                    <a href="#set-input-mode" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Input Mode</a>
                  </li>
                  <li>
                    <a href="#set-output-mode" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Output Mode</a>
                  </li>
                  <li>
                    <a href="#set-rotation" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Rotation</a>
                  </li>
                  <li>
                    <a href="#set-diverge" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Diverge</a>
                  </li>
                  <li>
                    <a href="#set-pitch-height" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Pitch/Height</a>
                  </li>
                  <li>
                    <a href="#set-stereo-rotation" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Stereo Rotation</a>
                  </li>
                  <li>
                    <a href="#set-stereo-spread" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Stereo Spread</a>
                  </li>
                  <li>
                    <a href="#set-auto-orbit" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Auto Orbit</a>
                  </li>
                  <li>
                    <a href="#set-isotropic-periphonic" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Isotropic / Periphonic</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#mach1decode-api" class="toc-h1 toc-link" data-title="Mach1Decode API">Mach1Decode API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#installation" class="toc-h2 toc-link" data-title="Mach1Decode API">Installation</a>
                  </li>
                  <li>
                    <a href="#set-angular-type" class="toc-h2 toc-link" data-title="Mach1Decode API">Set Angular Type</a>
                  </li>
                  <li>
                    <a href="#set-filter-speed" class="toc-h2 toc-link" data-title="Mach1Decode API">Set Filter Speed</a>
                  </li>
                  <li>
                    <a href="#begin-buffer" class="toc-h2 toc-link" data-title="Mach1Decode API">Begin Buffer</a>
                  </li>
                  <li>
                    <a href="#end-buffer" class="toc-h2 toc-link" data-title="Mach1Decode API">End Buffer</a>
                  </li>
                  <li>
                    <a href="#mach1spatial-decode" class="toc-h2 toc-link" data-title="Mach1Decode API">Mach1Spatial Decode</a>
                  </li>
                  <li>
                    <a href="#mach1horizon-decode" class="toc-h2 toc-link" data-title="Mach1Decode API">Mach1Horizon Decode</a>
                  </li>
                  <li>
                    <a href="#mach1horizonpairs-decode" class="toc-h2 toc-link" data-title="Mach1Decode API">Mach1HorizonPairs Decode</a>
                  </li>
                  <li>
                    <a href="#mach1spatialpairs-decode" class="toc-h2 toc-link" data-title="Mach1Decode API">Mach1SpatialPairs Decode</a>
                  </li>
                  <li>
                    <a href="#return-coefficients-example" class="toc-h2 toc-link" data-title="Mach1Decode API">Return Coefficients Example</a>
                  </li>
                  <li>
                    <a href="#get-current-time" class="toc-h2 toc-link" data-title="Mach1Decode API">Get Current Time</a>
                  </li>
                  <li>
                    <a href="#get-log" class="toc-h2 toc-link" data-title="Mach1Decode API">Get Log</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#mach1transcode-api" class="toc-h1 toc-link" data-title="Mach1Transcode API">Mach1Transcode API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#usage" class="toc-h2 toc-link" data-title="Mach1Transcode API">Usage</a>
                  </li>
                  <li>
                    <a href="#formats-supported" class="toc-h2 toc-link" data-title="Mach1Transcode API">Formats Supported</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#positional-spatial-functions" class="toc-h1 toc-link" data-title="Positional Spatial Functions">Positional Spatial Functions</a>
          </li>
          <li>
            <a href="#common-issues" class="toc-h1 toc-link" data-title="Common Issues">Common Issues</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#orientation-latency-issues" class="toc-h2 toc-link" data-title="Common Issues">Orientation Latency Issues</a>
                  </li>
                  <li>
                    <a href="#orientation-rate-issues-zipper" class="toc-h2 toc-link" data-title="Common Issues">Orientation Rate Issues (Zipper)</a>
                  </li>
                  <li>
                    <a href="#audio-visual-sync-issues" class="toc-h2 toc-link" data-title="Common Issues">Audio/Visual Sync Issues</a>
                  </li>
                  <li>
                    <a href="#spatial-decoding-phase-issues" class="toc-h2 toc-link" data-title="Common Issues">Spatial Decoding Phase Issues</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='http://www.mach1studios.com/signup'>Sign up for beta workflow tools</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>M1SDK includes APIs to allow developers to design applications that can encode or pan to a spatial audio render from audio streams and/or playback and decode Mach1Spatial 8channel spatial audio mixes with orientation to decode the correct stereo output sum of the user&#39;s current orientation. Additionally the M1SDK allows users to safely convert surround/spatial audio mixes to and from the Mach1Spatial or Mach1Horizon <strong>VVBP</strong> formats. </p>

<p><strong>VVBP</strong> or <em>Virtual Vector Based Panning</em> is a controlled virtual version of traditional <strong>VBAP</strong> (<em>Vector Based Amplitude Panning</em>) or <strong>SPS</strong> (<em>Spatial PCM Sampling</em>). These formats are designed for simplicity and ease of use &amp; implementation both for the content creators and the developers. The spatial audio mixes are based on only amplitude based coefficients changes for both encoding and decoding, and unlike many other spatial audio approaches, there are no additional signal altering processes (such as room modeling, delays or filters) to create coherent and accurate spatial sound fields and play them back from a first person headtracked perspective. Due to the simplicity of the format and cuboid vector space it relies on, it is also ideal for converting and carrying surround and spatial audio mixes without altering the mix to do so, making it an ideal server side audio middleman container. </p>
<h1 id='contents'>Contents</h1>
<p>The Mach1 Spatial SDK includes three components and libraries: </p>

<ul>
<li><strong><em>Mach1Encode lib:</em></strong>
Encode and process input streams/audio into a Mach1Spatial VVBP format.</li>
<li><strong><em>Mach1Decode lib:</em></strong>
Decode and process a Mach1Spatial VVBP format with device orientation / headtracking to output directional spatial audio.</li>
<li><strong><em>Mach1Transcode lib:</em></strong>
Transcode / convert any audio format (surround/spatial) to or from a Mach1Spatial VVBP format.</li>
</ul>
<h1 id='mach1encode-api'>Mach1Encode API</h1><h2 id='generate-point-results'>Generate Point Results</h2>
<p>Returns the resulting <code>points</code> coefficients based on selected and calculated input/output configuration.</p>
<pre class="highlight cpp tab-cpp"><code><span class="k">auto</span> <span class="n">points</span> <span class="o">=</span> <span class="n">m1Encode</span><span class="p">.</span><span class="n">generatePointResults</span><span class="p">();</span>
</code></pre><h2 id='set-input-mode'>Set Input Mode</h2>
<p>Sets the number of input streams to be positioned as points.</p>

<ul>
<li>INPUT_MONO</li>
<li>INPUT_STEREO</li>
<li>INPUT_QUAD</li>
<li>INPUT_AFORMAT</li>
<li>INPUT_BFORMAT</li>
</ul>
<pre class="highlight cpp tab-cpp"><code><span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: MONO
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_MONO</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: STERO
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_STEREO</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: Quad
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_QUAD</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: AFORMAT
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_AFORMAT</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: BFORMAT
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_BFORMAT</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><h2 id='set-output-mode'>Set Output Mode</h2>
<p>Sets the output spatial format, Mach1Spatial or Mach1Horizon</p>

<ul>
<li>OUTPUT_4CH (Mach1Horizon) [Yaw only]</li>
<li>OUTPUT_8CH (Mach1Spatial) [Yaw, Pitch, Roll]</li>
</ul>
<pre class="highlight cpp tab-cpp"><code><span class="k">if</span> <span class="p">(</span><span class="n">outputKind</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Output: Quad
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">outputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">OUTPUT_4CH</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">outputKind</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Output: 7.1
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">outputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">OUTPUT_8CH</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><h2 id='set-rotation'>Set Rotation</h2>
<p>Rotates the point(s) around the center origin of the vector space.</p>

<blockquote>
<p>UI value range: 0.0 -&gt; 1.0 (0-360)</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">;</span>
</code></pre><h2 id='set-diverge'>Set Diverge</h2>
<p>Moves the point(s) to/from center origin of the vector space.</p>

<blockquote>
<p>UI value range: -1.0 -&gt; 1.0</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">diverge</span> <span class="o">=</span> <span class="n">diverge</span><span class="p">;</span>
</code></pre><h2 id='set-pitch-height'>Set Pitch/Height</h2>
<p>Moves the point(s) up/down the vector space.</p>

<blockquote>
<p>UI value range: -1.0 -&gt; 1.0</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="n">pitch</span><span class="p">;</span>
</code></pre><h2 id='set-stereo-rotation'>Set Stereo Rotation</h2>
<p>Rotates the two stereo points around the axis of the center point between them.</p>

<blockquote>
<p>UI value range: -180.0 -&gt; 180.0</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">sRotate</span> <span class="o">=</span> <span class="n">sRotation</span><span class="p">;</span>
</code></pre><h2 id='set-stereo-spread'>Set Stereo Spread</h2>
<p>Increases or decreases the space between the two stereo points. </p>

<blockquote>
<p>UI value range: 0.0 -&gt; 1.0</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">sSpread</span> <span class="o">=</span> <span class="n">sSpread</span><span class="p">;</span>
</code></pre><h2 id='set-auto-orbit'>Set Auto Orbit</h2>
<p>When active both stereo points rotate in relation to the center point between them so that they always triangulate toward center of the cuboid.</p>

<blockquote>
<p>default value: true</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">autoOrbit</span> <span class="o">=</span> <span class="n">autoOrbit</span><span class="p">;</span>
</code></pre><h2 id='set-isotropic-periphonic'>Set Isotropic / Periphonic</h2>
<p>When active encoding behavior acts evenly with distribution across all azimuth/rotation angles and all altitude/pitch angles.</p>

<blockquote>
<p>default value: true</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">isotropicEncode</span> <span class="o">=</span> <span class="n">enableIsotropicEncode</span><span class="p">;</span>
</code></pre><h1 id='mach1decode-api'>Mach1Decode API</h1><h2 id='installation'>Installation</h2>
<p>Import and link the appropriate target device&#39;s / IDE&#39;s library file. </p>

<blockquote>
<p>shell:</p>
</blockquote>
<pre class="highlight plaintext"><code>rsync -aved  ../../../addons/ofxMach1/libs/lib/osx/libMach1DecodeCAPI.dylib  "$TARGET_BUILD_DIR/$PRODUCT_NAME.app/Contents/Frameworks/";
install_name_tool -change libMach1DecodeCAPI.dylib @executable_path/../Frameworks/libMach1DecodeCAPI.dylib "$TARGET_BUILD_DIR/$PRODUCT_NAME.app/Contents/MacOS/$PRODUCT_NAME";
</code></pre>
<aside class="notice">OF: when importing ofxMach1 add the following to your post-build script</aside>
<h2 id='set-angular-type'>Set Angular Type</h2>
<blockquote>
<p>Set the Angular Type for the target device via the enum
Use the <code>setAngularSettings</code> function to set the device&#39;s angle order and convention if applicable:</p>
</blockquote>
<h3 id='preset-types-enum'>Preset Types(enum):</h3>
<ul>
<li>m1Default</li>
<li>m1Unity</li>
<li>m1UE</li>
<li>m1oFEasyCam</li>
<li>m1Android</li>
<li>m1iOSPortrait</li>
<li>m1iOSLandscape</li>
</ul>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">setAngularSettingsType</span><span class="p">(</span><span class="n">m1Default</span><span class="p">);</span>
</code></pre>
<!-- ```android
mach1Decode.setAngularSettingsType(Mach1Decode::AngularSettingsType::m1Android);
``` -->
<pre class="highlight swift tab-swift"><code><span class="n">mach1Decode</span><span class="o">.</span><span class="nf">setAngularSettingsType</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="kt">AngularSettingsType</span><span class="o">.</span><span class="n">m1iOSPortrait</span><span class="p">)</span>
</code></pre><h3 id='angle-order-conventions'>Angle Order Conventions</h3>
<ol>
<li>Order of Yaw, Pitch, Roll (Defined as angle applied first, second and third).</li>
<li>Direction of transform around each pole&#39;s positive movement (left or right rotation).</li>
<li>integer Range before tranform completes 2(PI).</li>
</ol>

<table><thead>
<tr>
<th style="text-align: right">Order</th>
<th style="text-align: right">airplane</th>
<th style="text-align: right">telescope</th>
<th style="text-align: right">symbol</th>
<th style="text-align: right">angular velocity</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right">applied first</td>
<td style="text-align: right">heading</td>
<td style="text-align: right">azimuth</td>
<td style="text-align: right">θ (theta)</td>
<td style="text-align: right">yaw</td>
</tr>
<tr>
<td style="text-align: right">applied second</td>
<td style="text-align: right">attitude</td>
<td style="text-align: right">elevation</td>
<td style="text-align: right">φ (phi)</td>
<td style="text-align: right">pitch</td>
</tr>
<tr>
<td style="text-align: right">applied last</td>
<td style="text-align: right">bank</td>
<td style="text-align: right">tilt</td>
<td style="text-align: right">ψ (psi)</td>
<td style="text-align: right">roll</td>
</tr>
</tbody></table>
<h3 id='euler-angle-orders'>Euler Angle Orders:</h3>
<ul>
<li>(yaw-pitch-roll)</li>
<li>Unity: Left handed x-y-z (pitch-roll-yaw)</li>
<li>Unreal Engine: Right handed z-y-x </li>
</ul>
<h2 id='set-filter-speed'>Set Filter Speed</h2>
<p>Filter speed determines the amount of angle smoothing applied to the orientation angles used for the Mach1Decode class. 1.0 would mean that there is no filtering applied, 0.1 would add a long ramp effect of intermediary angles between each angle sample. It should be noted that you will not have any negative effects with &gt;0.9 but could get some orientation latency when &lt;0.85.</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">float</span> <span class="n">filterSpeed</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">f</span><span class="p">;</span>

<span class="n">mach1Decode</span><span class="p">.</span><span class="n">setFilterSpeed</span><span class="p">(</span><span class="n">filterSpeed</span><span class="p">);</span>
</code></pre><h2 id='begin-buffer'>Begin Buffer</h2><h2 id='end-buffer'>End Buffer</h2><h2 id='mach1spatial-decode'>Mach1Spatial Decode</h2>
<p>8 Channel spatial mix decoding from our cuboid configuration. 
This is the default and recommended decoding utilizing isotropic decoding behavior.</p>

<blockquote>
<p>Default Isotropic Decoding: </p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">spatialAlgo</span><span class="p">(</span><span class="kt">float</span> <span class="n">deviceYaw</span><span class="p">,</span> <span class="kt">float</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="kt">float</span> <span class="n">deviceRoll</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bufferSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sampleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Alternative Periphonic Decoding:</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">spatialAltAlgo</span><span class="p">(</span><span class="kt">float</span> <span class="n">deviceYaw</span><span class="p">,</span> <span class="kt">float</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="kt">float</span> <span class="n">deviceRoll</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bufferSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sampleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
</code></pre>
<p>Add headlocked / noon-diegetic stereo mix to the output summed coefficients.</p>
<h2 id='mach1horizon-decode'>Mach1Horizon Decode</h2>
<p>4 channel spatial mix decoding for compass / yaw only configurations.
Also able to decode and virtualize a first person perspective of Quad Surround mixes. </p>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">horizonAlgo</span><span class="p">(</span><span class="kt">float</span> <span class="n">deviceYaw</span><span class="p">,</span> <span class="kt">float</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="kt">float</span> <span class="n">deviceRoll</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bufferSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sampleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
</code></pre>
<p>Add headlocked / noon-diegetic stereo mix to the output summed coefficients.</p>
<h2 id='mach1horizonpairs-decode'>Mach1HorizonPairs Decode</h2>
<p>8 channel spatial mix decoding for compass / yaw only that can support headlocked / non-diegetic stereo elements to be mastered within the mix / 8 channels.</p>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">horizonPairsAlgo</span><span class="p">(</span><span class="kt">float</span> <span class="n">deviceYaw</span><span class="p">,</span> <span class="kt">float</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="kt">float</span> <span class="n">deviceRoll</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bufferSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sampleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
</code></pre><h2 id='mach1spatialpairs-decode'>Mach1SpatialPairs Decode</h2>
<aside class="warning">This function of decoding is deprecated and only helpful for experimental use cases!</aside>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">spatialPairsAlgo</span><span class="p">(</span><span class="kt">float</span> <span class="n">deviceYaw</span><span class="p">,</span> <span class="kt">float</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="kt">float</span> <span class="n">deviceRoll</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bufferSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sampleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
</code></pre><h2 id='return-coefficients-example'>Return Coefficients Example</h2>
<p>Input orientation angles and return the current sample/buffers coefficients</p>

<blockquote>
<p>Sample based example</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">volumes</span> <span class="o">=</span> <span class="n">mach1Decode</span><span class="p">.</span><span class="n">spatialAlgo</span><span class="p">(</span><span class="n">deivceYaw</span><span class="p">,</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="n">deviceRoll</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">playersLeft</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">setVolume</span><span class="p">(</span><span class="n">volumes</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">overallVolume</span><span class="p">);</span>
    <span class="n">playersRight</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">setVolume</span><span class="p">(</span><span class="n">volumes</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">overallVolume</span><span class="p">);</span>
<span class="p">}</span>
</code></pre><pre class="highlight swift tab-swift"><code><span class="c1">//Send device orientation to m1obj with the preferred algo</span>
<span class="k">let</span> <span class="nv">decodeArray</span><span class="p">:</span> <span class="p">[</span><span class="kt">Float</span><span class="p">]</span>  <span class="o">=</span> <span class="n">m1obj</span><span class="o">.</span><span class="nf">spatialAlgo</span><span class="p">(</span><span class="kt">Yaw</span><span class="p">:</span> <span class="kt">Float</span><span class="p">(</span><span class="n">deviceYaw</span><span class="p">),</span> <span class="kt">Pitch</span><span class="p">:</span> <span class="kt">Float</span><span class="p">(</span><span class="n">devicePitch</span><span class="p">),</span> <span class="kt">Roll</span><span class="p">:</span> <span class="kt">Float</span><span class="p">(</span><span class="n">deviceRoll</span><span class="p">))</span>

<span class="c1">//Use each coeff to decode multichannel Mach1 Spatial mix</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">...</span><span class="mi">7</span> <span class="p">{</span>
    <span class="n">players</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">decodeArray</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">players</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">decodeArray</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

    <span class="nf">print</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="n">players</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">currentTime</span><span class="p">)</span> <span class="o">+</span> <span class="s">" ; "</span> <span class="o">+</span> <span class="kt">String</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="n">players</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">currentTime</span><span class="p">)</span> <span class="o">+</span> <span class="s">" ; "</span> <span class="o">+</span> <span class="kt">String</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Buffer based example</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="c1">//16 coefficients of spatial, 2 coefficients of headlocked stereo
</span><span class="kt">float</span> <span class="n">volumes</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span>

<span class="n">mach1Decode</span><span class="p">.</span><span class="n">beginBuffer</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">samples</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">mach1Decode</span><span class="p">.</span><span class="n">spatialAlgo</span><span class="p">(</span><span class="n">Yaw</span><span class="p">,</span> <span class="n">Pitch</span><span class="p">,</span> <span class="n">Roll</span><span class="p">,</span> <span class="n">volumes</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">sndL</span> <span class="o">+=</span> <span class="n">volumes</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">idx</span><span class="p">];</span>
        <span class="n">sndR</span> <span class="o">+=</span> <span class="n">volumes</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">idx</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="n">buf</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span> <span class="p">(</span><span class="n">sndL</span> <span class="o">*</span> <span class="p">(</span><span class="n">SHRT_MAX</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
    <span class="n">buf</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span> <span class="p">(</span><span class="n">sndR</span> <span class="o">*</span> <span class="p">(</span><span class="n">SHRT_MAX</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>
<span class="n">mach1Decode</span><span class="p">.</span><span class="n">endBuffer</span><span class="p">();</span>
<span class="n">bufferRead</span> <span class="o">+=</span> <span class="n">samples</span><span class="p">;</span>
</code></pre><h2 id='get-current-time'>Get Current Time</h2><h2 id='get-log'>Get Log</h2><h1 id='mach1transcode-api'>Mach1Transcode API</h1>
<aside class="notice">Please select `shell`</aside>
<h2 id='usage'>Usage</h2>
<p>Rapidly offline render to and from Mach1 formats. Supports expansion of more formats and more cross-conversions if requested.</p>

<blockquote>
<p>Example of usage in shell:</p>
</blockquote>
<pre class="highlight plaintext"><code>m1-fmtconv -in-file /path/to/file.wav -in-fmt tbe -out-fmt M1Spatial -out-file /path/to/output.wav
</code></pre><h2 id='formats-supported'>Formats Supported</h2>
<ul>
<li>Stereo - L &amp; R spatialized</li>
<li>Stereo_Cinema - L &amp; R spatialized, forward focus</li>
<li>LCR - L &amp; R spatialized with C mono</li>
<li>M1Horizon (Mach1 Horizon / Quad) - L R Ls Rs</li>
<li>M1Horizon+S (Mach1 Horizon / Quad) - L R Ls Rs StereoL StereoR</li>
<li>M1HorizonPairs (Mach1 Horizon / Quad-Binaural) - FrontPair, LeftPair, RearPair, RightPair</li>
<li>M1Spatial (Mach1Spatial) - Upper L R Ls Rs, Lower L R Ls Rs</li>
<li>M1Spatial+S (Mach1Spatial) - Upper L R Ls Rs, Lower L R Ls Rs, StereoL StereoR</li>
<li>M1SpatialPairs (Mach1Spatial Pairs) - Upper front, left, rear, right, pairs, then lower same</li>
<li>M1SpatialFaces - Encoder for mono to cube faces</li>
<li>FiveOh - L C R Ls Rs</li>
<li>FiveOneFilm (Pro Tools default) - L C R Ls Rs LFE</li>
<li>FiveOneFilm_Cinema (Pro Tools default) - L C R Ls Rs LFE, forward focus</li>
<li>FiveOneSmpte (SMPTE/ITU for Dolby Digital - L R C LFE Ls Rs</li>
<li>FiveOneDts (DTS) - L R Ls Rs C LFE</li>
<li>SevenOnePT (Pro Tools default) - L C R Lss Rss Lsr Rsr LFE</li>
<li>SevenOnePT_Cinema (Pro Tools default) - L C R Lss Rss Lsr Rsr LFE, forward focus</li>
<li>SevenZero_Cinema - L C R Lss Rss Lsr Rsr, forward focus</li>
<li>SevenOneSDDS (Sony SDDS) - L Lc C Rc R Ls Rs LFE</li>
<li>SevenZeroSDDS (Sony SDDS) - L Lc C Rc R Ls Rs</li>
<li>FiveOneTwo - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>FiveZeroTwo - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>FiveOneFour - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>FiveZeroFour - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>SevenOneTwo - L C R Lss Rss Lsr Rsr LFE Lts Rts</li>
<li>SevenZeroTwo - L C R Lss Rss Lsr Rsr Lts Rts</li>
<li>SevenOneFour - L C R Lss Rss Lsr Rsr LFE FLts FRts BLts BRts</li>
<li>SevenZeroFour - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>NineOne </li>
<li>NineZero</li>
</ul>

<p>Ambisonics (special thanks to VVAudio):
 - ACNSN3D - 1st order B-format, ACN order and SN3D weighting
 - FuMa - 1st order B-format, Furse-Malham order and weighting
 - ACNSN3DO2A - 2nd order B-format, AmbiX ACN order and SN3D weighting
 - FuMaO2A - 2nd order B-format, Furse-Malham order and weighting
 - TBE - Facebook360 Hybrid 2nd order
 - ACNSN3DO3A - 3rd order B-format, AmbiX ACN order and SN3D weighting
 - FuMaO3A - 3rd order B-format, Furse-Malham order and weighting</p>
<h1 id='positional-spatial-functions'>Positional Spatial Functions</h1><h1 id='common-issues'>Common Issues</h1>
<p>The following is a list of common heard issues during implementation and include audio tools to help find these issues as well as basic descriptions of their behavior and how they can be avoided.</p>
<h3 id='orientation-latency-issues'>Orientation Latency Issues</h3>
<aside class="notice">Orientation Latency is usually the biggest concern in the current climate of devices that need some sort of headtracking or window tracking. This is an issue for visuals but just as much for audio as well, if the angles inputted into the Mach1Decode functions are late then so are the returned coefficients which leads to the user losing immersion and effect.
</aside>
<h3 id='orientation-rate-issues-zipper'>Orientation Rate Issues (Zipper)</h3>
<aside class="notice">
If the rate of angles sending to the app layer with Mach1Decode integrated is too slow, this can cause some audible distortion / clicking issues added to the mix. The effect will sound like a zipper as you headtrack faster and faster. This is due to the difference of the returned coefficients being too large from result to result, causing the gain change applied to be too large and creating a "jump". We have included ways to filter the input angles into our functions however this is a band-aid to the issue if your target device has this issue. The idea is to filter and delay the inputting angles adding more intermidiary angles between each "jump" but at the cost of Orientation Latency (see above).
</aside>
<pre class="highlight cpp tab-cpp"><code>
</code></pre><h3 id='audio-visual-sync-issues'>Audio/Visual Sync Issues</h3>
<aside class="notice">
It is important to ensure sync between a visual element in your project / application and the spatial audio mix. Ensure they are managed by the same function receiving the same call.
</aside>
<h3 id='spatial-decoding-phase-issues'>Spatial Decoding Phase Issues</h3>
<aside class="notice">
If you have your spatial audio streams coming from different audio managers that do not have sync between them you will start hearing strange channel phasing issues while you track your head orientation or device orientation. Eliminate these by ensuring your audio is called at the same time and managed properly. 
</aside>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="cpp">cpp</a>
                <a href="#" data-language-name="swift">swift</a>
          </div>
      </div>
    </div>
  </body>
</html>
